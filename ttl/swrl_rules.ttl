@prefix : <http://www.example.org/apartment-subscription-ontology#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix swrl: <http://www.w3.org/2003/11/swrl#> .
@prefix swrlb: <http://www.w3.org/2003/11/swrlb#> .

###############################################################################
#
#    SWRL Rules (SWRL 규칙)
#
#    이 파일은 OWL만으로 표현하기 어려운 계산, 집계, 조건부 로직을
#    SWRL(Semantic Web Rule Language) 규칙으로 구현합니다.
#
#    참고: SWRL 규칙은 추론 엔진(Pellet, HermiT 등)에서 실행되며,
#          일부 built-in 함수는 엔진에 따라 지원 여부가 다를 수 있습니다.
#
###############################################################################

###############################################################################
#    1. 소득 기준 관련 규칙
###############################################################################

# 규칙 1: 육아휴직 급여 소득 산정
# CQ 24 대응
<urn:swrl:rule1> rdf:type swrl:Imp ;
    rdfs:label "육아휴직 급여 소득 산정"@ko ;
    rdfs:comment "육아휴직 중인 세대원의 육아휴직 급여를 개인 소득으로 산정합니다."@ko ;
    swrl:body [
        rdf:type swrl:AtomList ;
        rdf:first [
            rdf:type swrl:ClassAtom ;
            swrl:classPredicate :Person ;
            swrl:argument1 [ rdf:type swrl:Variable ; swrl:variableName "p" ]
        ] ;
        rdf:rest [
            rdf:type swrl:AtomList ;
            rdf:first [
                rdf:type swrl:DatavaluedPropertyAtom ;
                swrl:propertyPredicate :isOnChildcareLeave ;
                swrl:argument1 [ rdf:type swrl:Variable ; swrl:variableName "p" ] ;
                swrl:argument2 [ rdf:type swrl:Variable ; swrl:variableName "true" ]
            ] ;
            rdf:rest [
                rdf:type swrl:AtomList ;
                rdf:first [
                    rdf:type swrl:DatavaluedPropertyAtom ;
                    swrl:propertyPredicate :childcareLeaveAllowance ;
                    swrl:argument1 [ rdf:type swrl:Variable ; swrl:variableName "p" ] ;
                    swrl:argument2 [ rdf:type swrl:Variable ; swrl:variableName "allowance" ]
                ] ;
                rdf:rest rdf:nil
            ]
        ]
    ] ;
    swrl:head [
        rdf:type swrl:AtomList ;
        rdf:first [
            rdf:type swrl:DatavaluedPropertyAtom ;
            swrl:propertyPredicate :personalIncome ;
            swrl:argument1 [ rdf:type swrl:Variable ; swrl:variableName "p" ] ;
            swrl:argument2 [ rdf:type swrl:Variable ; swrl:variableName "allowance" ]
        ] ;
        rdf:rest rdf:nil
    ] .

# 규칙 2: 맞벌이 가구 판정
# 부부가 모두 소득이 있는 경우 맞벌이 가구로 분류
<urn:swrl:rule2> rdf:type swrl:Imp ;
    rdfs:label "맞벌이 가구 판정"@ko ;
    rdfs:comment "부부가 모두 소득이 있는 경우 맞벌이 가구로 분류합니다. 신혼부부 특별공급에서 소득 기준 160% 적용에 사용됩니다."@ko .
    # Note: Full SWRL syntax is verbose. This is a placeholder structure.
    # In practice, SWRL rules are often defined using functional syntax or
    # rule editors in tools like Protégé.

###############################################################################
#    2. 청약통장 관련 규칙
###############################################################################

# 규칙 10: 청약통장 가입 기간 계산 (년 단위)
<urn:swrl:rule10> rdf:type swrl:Imp ;
    rdfs:label "청약통장 가입 기간 계산"@ko ;
    rdfs:comment "청약통장 개설일로부터 현재까지의 기간을 년 단위로 계산합니다."@ko .

# 규칙 11: 청약통장 가입 기간 요건 충족 (2년 이상)
# CQ 2 대응
<urn:swrl:rule11> rdf:type swrl:Imp ;
    rdfs:label "청약통장 가입 기간 요건 충족"@ko ;
    rdfs:comment "1순위 청약에 필요한 2년 가입 기간 충족 여부를 판단합니다."@ko .

# 규칙 12: 예치금 부족분 계산
# CQ 12 대응
<urn:swrl:rule12> rdf:type swrl:Imp ;
    rdfs:label "예치금 부족분 계산"@ko ;
    rdfs:comment "신청자의 현재 예치금과 필요 예치금의 차액을 산출합니다."@ko .

###############################################################################
#    3. 무주택 및 주택 소유 관련 규칙
###############################################################################

# 규칙 13: 소형·저가주택 처분 후 무주택 기간 산정
# CQ 5 대응
# 설계 변경: SmallLowPriceHousing은 Defined Class로 변경됨
<urn:swrl:rule13> rdf:type swrl:Imp ;
    rdfs:label "소형·저가주택 처분 후 무주택 기간 산정"@ko ;
    rdfs:comment """소형·저가주택을 처분한 날짜를 무주택 기간 시작일로 설정합니다.
    소형·저가주택: 면적 60㎡ 이하, 가격 1억3천만원 이하, 수도권 소재"""@ko .

# 규칙 14: 무주택 기간 계산 (년 단위)
<urn:swrl:rule14> rdf:type swrl:Imp ;
    rdfs:label "무주택 기간 계산"@ko ;
    rdfs:comment "무주택 시작일로부터 현재까지의 기간을 년 단위로 계산합니다."@ko .

###############################################################################
#    4. 재당첨 제한 관련 규칙
###############################################################################

# 규칙 15: 5년 이내 당첨 이력 확인
# CQ 6, 11 대응
<urn:swrl:rule15> rdf:type swrl:Imp ;
    rdfs:label "5년 이내 당첨 이력 확인"@ko ;
    rdfs:comment "세대원 중 5년 이내 청약 당첨 이력이 있는지 확인합니다."@ko .

# 규칙 16: 세대 내 제한 기간 중 당첨자 확인
<urn:swrl:rule16> rdf:type swrl:Imp ;
    rdfs:label "세대 내 제한 기간 중 당첨자 확인"@ko ;
    rdfs:comment "세대원 중 한 명이라도 제한 기간 중이면 세대 전체 1순위 자격 상실입니다."@ko .

###############################################################################
#    5. 자녀 및 부양가족 관련 규칙
###############################################################################

# 규칙 17: 태아 포함 미성년 자녀 수 계산
# CQ 15 대응
<urn:swrl:rule17> rdf:type swrl:Imp ;
    rdfs:label "태아 포함 미성년 자녀 수 계산"@ko ;
    rdfs:comment "만 19세 미만 자녀 수 + 태아 수 = 총 자녀 수를 산정합니다. 다자녀가구 특별공급 자격 판단 시 사용됩니다."@ko .

# 규칙 18: 인정 부양가족 수 계산
<urn:swrl:rule18> rdf:type swrl:Imp ;
    rdfs:label "인정 부양가족 수 계산"@ko ;
    rdfs:comment "만 65세 이상 또는 만 19세 미만 세대원 수를 계산합니다. 가점제에서 부양가족 수에 따른 가점 산정에 사용됩니다."@ko .

###############################################################################
#    6. 생애최초 특공 관련 규칙
###############################################################################

# 규칙 19: 소득세 납부 통산 기간 계산
<urn:swrl:rule19> rdf:type swrl:Imp ;
    rdfs:label "소득세 납부 통산 기간 계산"@ko ;
    rdfs:comment "신청자의 과거 소득세 납부 연도 수를 합산합니다. 생애최초 특별공급은 5년 이상 소득세 납부 이력이 필요합니다."@ko .

# 규칙 20: 생애최초 자격 판정 (세대원 전원 무소유)
# CQ 19 대응
<urn:swrl:rule20> rdf:type swrl:Imp ;
    rdfs:label "생애최초 자격 판정"@ko ;
    rdfs:comment "신청자 본인 및 세대원 전원이 단 한 번도 주택을 소유한 적이 없는지 확인합니다."@ko .

###############################################################################
#    7. 자산 기준 관련 규칙
###############################################################################

# 규칙 7: 세대 총 부동산 자산 합산
<urn:swrl:rule7> rdf:type swrl:Imp ;
    rdfs:label "세대 총 부동산 자산 합산"@ko ;
    rdfs:comment "세대원 전체의 토지 및 건물 자산 가액을 합산합니다."@ko .

# 규칙 8: 세대 총 자동차 자산 합산
<urn:swrl:rule8> rdf:type swrl:Imp ;
    rdfs:label "세대 총 자동차 자산 합산"@ko ;
    rdfs:comment "세대원 전체의 자동차 자산 가액을 합산합니다."@ko .

# 규칙 9: 국민주택 자산 기준 충족 여부
# CQ 21 대응
<urn:swrl:rule9> rdf:type swrl:Imp ;
    rdfs:label "국민주택 자산 기준 충족 여부"@ko ;
    rdfs:comment """세대의 부동산 및 자동차 자산이 국민주택 기준 이하인지 판단합니다.
    기준: 부동산 2억 1,500만원 이하, 자동차 3,708만원 이하"""@ko .

###############################################################################
#    8. 소득 기준 관련 규칙 (계속)
###############################################################################

# 규칙 3: 맞벌이 가구 판정 (상세)
<urn:swrl:rule3> rdf:type swrl:Imp ;
    rdfs:label "맞벌이 가구 판정 (상세)"@ko ;
    rdfs:comment "부부가 모두 소득이 있는 경우 맞벌이 가구로 분류합니다."@ko .

# 규칙 4: 가구원 수 계산
<urn:swrl:rule4> rdf:type swrl:Imp ;
    rdfs:label "가구원 수 계산"@ko ;
    rdfs:comment "세대의 구성원 수를 계산하여 적절한 도시근로자 소득 기준을 선택합니다."@ko .

# 규칙 5: 소득 기준 충족 여부 판단
# CQ 20, 22 대응
<urn:swrl:rule5> rdf:type swrl:Imp ;
    rdfs:label "소득 기준 충족 여부 판단"@ko ;
    rdfs:comment """신청자의 세대 소득이 특정 소득 기준선 이하인지 판단합니다.
    1. 신청자의 세대 월평균 소득과 가구원 수 확인
    2. 해당 가구원 수의 2024년 도시근로자 소득 기준 조회
    3. 적용할 소득 기준선(100%, 130%, 140%, 160%)의 비율 확인
    4. 기준 금액 × 비율 / 100 = 소득 한도 계산
    5. 세대 소득이 소득 한도 이하이면 기준 충족"""@ko .

# 규칙 6: 1인 가구 소득 기준 특례
# CQ 23 대응
<urn:swrl:rule6> rdf:type swrl:Imp ;
    rdfs:label "1인 가구 소득 기준 특례"@ko ;
    rdfs:comment "생애최초 특공에서 1인 가구는 2인 가구 소득 기준을 적용받습니다."@ko .

###############################################################################
#
#    참고사항:
#
#    1. SWRL 규칙의 완전한 구문은 매우 장황하며, 실제로는 Protégé와 같은
#       온톨로지 편집기의 SWRL 규칙 편집기를 사용하여 작성하는 것이 일반적입니다.
#
#    2. 본 파일에서는 각 규칙의 구조(swrl:Imp)와 메타데이터(label, comment)를
#       정의하고, 실제 규칙 본문은 간략화된 형태로 표현했습니다.
#
#    3. 실제 구현 시에는 swrl:body와 swrl:head에 완전한 Atom 리스트를
#       정의해야 하며, built-in 함수(swrlb:add, swrlb:lessThanOrEqual 등)를
#       사용하여 계산 로직을 구현합니다.
#
#    4. SWRL 규칙의 실행은 추론 엔진에 의존하며, 날짜 연산, 집계 함수 등
#       일부 기능은 엔진에 따라 지원 여부가 다를 수 있습니다.
#
#    5. 복잡한 계산이나 집계는 SPARQL 쿼리 + 애플리케이션 로직으로
#       대체하는 것이 더 효율적일 수 있습니다.
#
#    규칙 상세 정의:
#    - swrl_rules.md 문서 참조
#    - Protégé SWRL 탭에서 규칙 편집 권장
#
###############################################################################

###############################################################################
#
#    규칙 통계 요약
#
#    소득 관련: 6개 (규칙 1-6)
#    자산 관련: 3개 (규칙 7-9)
#    청약통장 관련: 3개 (규칙 10-12)
#    무주택 관련: 2개 (규칙 13-14)
#    재당첨 제한: 2개 (규칙 15-16)
#    자녀/부양가족: 2개 (규칙 17-18)
#    생애최초: 2개 (규칙 19-20)
#    총합: 20개
#
###############################################################################

